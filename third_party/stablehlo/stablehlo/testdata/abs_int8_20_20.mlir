// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi8> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xi8>
    %1 = call @expected() : () -> tensor<20x20xi8>
    %2 = stablehlo.abs %0 : tensor<20x20xi8>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi8>, tensor<20x20xi8>) -> ()
    return %2 : tensor<20x20xi8>
  }
  func.func private @inputs() -> (tensor<20x20xi8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x030001FCFDFF04FE0400FC0203FFFE04000105FF02FCFE0101FC0201FFFDFDFC0002FA0000FB00FEFDFA02FF0000000000010100FB0000FD01FEFFFC0105FE000201FF00050001030000030200FF00FC050402FD05FC0001FB02FF0103FF00FF04000002FAFEFE00FE0107010104FE01FDFB0103FE00000100000003FD0301FF00FE01FDFEFD00000100FD0001FFFD00FBFE03FD0302FF000201FA00FE04FFFEFE0100010104FF0101FD00FEFD000400FD01FF00FFFF00040001FE030003FF0003FFFDFFFE0003FBFE00FC03FC00FC0106FD00FBFFFEFF0001FE0201FF060102000200000000FEF5FF00030407FE0000FFFDFE01FFFE010302010004FE000401FFFC00FB000101FE01020207010000000102FC000000FE030504000105FD00FE02F90202FF02FEFFFBFF0000FF0006FFFFFC0202FC01FE00FD020001FF0005FBFFFF0000FCFB030600020302FFFA000200FFFF03FF02000103FE0001FCFD00FD00FF000200000200FEFF0202FF020000FFFEFFFF050500FE00FEFF0104FEFDFD000407FD02FF030000000000F900FE00"> : tensor<20x20xi8>
    return %c : tensor<20x20xi8>
  }
  func.func private @expected() -> (tensor<20x20xi8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x0300010403010402040004020301020400010501020402010104020101030304000206000005000203060201000000000001010005000003010201040105020002010100050001030000030200010004050402030504000105020101030100010400000206020200020107010104020103050103020000010000000303030101000201030203000001000300010103000502030303020100020106000204010202010001010401010103000203000400030101000101000400010203000301000301030102000305020004030400040106030005010201000102020101060102000200000000020B010003040702000001030201010201030201000402000401010400050001010201020207010000000102040000000203050400010503000202070202010202010501000001000601010402020401020003020001010005050101000004050306000203020106000200010103010200010302000104030003000100020000020002010202010200000102010105050002000201010402030300040703020103000000000007000200"> : tensor<20x20xi8>
    return %c : tensor<20x20xi8>
  }
}

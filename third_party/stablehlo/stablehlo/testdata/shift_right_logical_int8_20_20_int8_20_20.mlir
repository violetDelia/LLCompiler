// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi8> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi8>, tensor<20x20xi8>)
    %1 = call @expected() : () -> tensor<20x20xi8>
    %2 = stablehlo.shift_right_logical %0#0, %0#1 : tensor<20x20xi8>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi8>, tensor<20x20xi8>) -> ()
    return %2 : tensor<20x20xi8>
  }
  func.func private @inputs() -> (tensor<20x20xi8> {mhlo.layout_mode = "default"}, tensor<20x20xi8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x000401FDFF03FCFEFE010007010001FBFDFDFDFEFFFC01FEFEFEFD0508000302FEFD0506FEFC02FC0101000004000002020201FDFDFFFD00000500FFFC0102030400FF03FEFE0000FC06FC00FD080507020001FFFF0005FF02FF00FE0301FD0600FF0201FEFFFE0300050101010000FF0300FCFE0300FFFFFF02000003FEFCFD02FAFBFEFC01FFFF0000FF05FD010200010204FE020100FF07FF0200FFFD0000FFFC00FC01000300FF050000FC0000FF02FCFEFD07FD0002FC03FE00FE0300FCFFFE01000003FFFBFEFA0001FEFFFD04FD030203FD030000FB00FDFC00FB05FF000004F900FE0300FE0001000101FE00050000FBFD02FD00FF00FDFA000402010000020200010700FEFF0003FD0200FEFD000100FE000204FDFFFE00040200040003FE000000FF00FB0300010101010602FC00FE03FFFF05FFFE040401FE00000002030407090300FD0102010100FD030102FDFE02000103FE0305FD01020006000001FCFE020300FD02FDFEFFFF01FF00FD05FD0500FEFE01FCFF01FDFFFC00FD00FE01FB01FEFD0302FF02000402FE"> : tensor<20x20xi8>
    %c_0 = stablehlo.constant dense<"0x00FD00000000020000FC00020000FE05FF04FF01FFFD05FEFF00FF00FC03000103030200F80000000006000003030A0106FB01FF010200FCFF04070001FFFFFF02FF010305FB0000FDFAFF02000002FF0404FC0102000200FC00010000FE030001FE01FEFF03FFFFFF0402FEFF02FC00FB05FC09FFFB0000FF01FE030300FCFE010302FF000400FA0200040605000103FDFEFFFDFE00FC07FFFB06000001030000070001FF0000FDFEFDFF04000000FDFF0103FFFA0500FC010300FEFC00F900000303FEFD0100FEFFFF050001FDFDFFFC0200000101FF00FF01000002FFFF010100000205010301FD0300FC05FE02020300F902F7FF010005FFFC0005FFFF0001FE00FE01FD0600FF000100010302020003000000FF00000400010408FF05FEFE0101FEFB0203FD0102FE05FCFFFDFBFB000200FD0207FF00FC00040000FD030300FFFD03FE03FE0301FFFA0201FB0200FE00FC00FD0202FF00000002FE0400030404FA000200000000FD0005FC00FEFF0104030202FF0000000002010301FF0307FF04FFFAFDFA04FE0101FDFD0000"> : tensor<20x20xi8>
    return %c, %c_0 : tensor<20x20xi8>, tensor<20x20xi8>
  }
  func.func private @expected() -> (tensor<20x20xi8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x000001FDFF033FFEFE00000101000007000F007F0000000000FE0005000003011F1F010600FC02FC0100000000000001000000007E3FFD00000000FF7E00000001007F000700000000000000FD0801000000007F3F0001FF00FF00FE03001F0600000100001F000000000000000000FF000000000000FFFF0001000000FE0000011F3E00FC00FF0000000F0007010100000000000001000100000000FF7E0000FF01007E0000030000000000FC000000007E1F00000700007E00FE00000300FCFF1F00000001FF00000000017F000000000002037E0100000000FDFC0000007F0000043E007F00000000010000003F000000003E00007E00070000FA00000001000002000000000000FF00037E00003FFD000100FE0002040FFF7F000000000000017F0000001F007D0000000000000000FC00FE003F0100FF00040001FE000000020000000000001F000000000000000100FD0002000000000305FD0000000600000000FE000300FD0200FE07000100007E001F010000FE01FCFF007E1F7E001F0000000000000000007F01000002FE"> : tensor<20x20xi8>
    return %c : tensor<20x20xi8>
  }
}

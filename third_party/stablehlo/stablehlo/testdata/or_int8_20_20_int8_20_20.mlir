// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi8> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0:2 = call @inputs() : () -> (tensor<20x20xi8>, tensor<20x20xi8>)
    %1 = call @expected() : () -> tensor<20x20xi8>
    %2 = stablehlo.or %0#0, %0#1 : tensor<20x20xi8>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi8>, tensor<20x20xi8>) -> ()
    return %2 : tensor<20x20xi8>
  }
  func.func private @inputs() -> (tensor<20x20xi8> {mhlo.layout_mode = "default"}, tensor<20x20xi8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFD0300FEFFFF0200020100FB01FE000302FDFE0003FC0000000002050001FF02000000FEFC0100FC0200FF04FE03FF000000020201010300030100FE02000100000000FF010100FFFF0106020002FE00010003FEFF01FF02FCFC010001F703FF00FEFF0302FFFD0402FEFFFE03FFFF02FF00020000FFFDFEFFF90502FE01FB03FD03FD03010004FDFE0401FE0004FDFC00FFFFFC02FD02FDFB00040400FD02FE0001FE00FCFE0400FFFE00010000FF02FC000001FF0002010208FFFCFC00FF0007FE0300000001FF00FD0204FE0200000000000102FE010104FEFBFD0002FF02FBFD02FD00000701FEFD0105030004FCFE00FF02FCFA030300FF0100FB00FD000000FC01FFFBFA00FA0201FE00FDFC02FF03FD02FF00FD00FC00030402000001FAFE010000FB01FB0102020002FE020000010002010302000005FE01FF00FF03FE01FE040000F9FF01FFFF0106FE020101FF0601FE02010203FDFCFFFF00FEFC0000FA00FF02FD0201FC030500FFFE0003FFFFFE00FFFEFEFEFE01FD00FF0002030002FEFDFE000005020000FF0503FB"> : tensor<20x20xi8>
    %c_0 = stablehlo.constant dense<"0x0103FEFDFFFF00FFFC04FEFF060501000104FB000103FEFD0100040403FF00FE00FDFEFC0002FFFDFF0000F9FDFE0100FD00000000FEFD0100FD00FCFD0003000106FBFE0001FD00FF070401FC02FE050004FF000304FC03FC0602FEFD02FF05000000FF0301FFFFFE000302FBFAFDFF000601000205FD00010003FB01060002FF01FBFDFF0100FE0200FA01FC00FD040000FD020104FF050000FC00FF04020200FF02FEFA02FDFD02FD01010404010300010100FD0002000101FF0001FD00FF010400000400FE00FE00000100020000000003FDFE00FF000103FEFD000305FD03020000000106FE0103FE0003FF03FFFE0301FE0205020001FD00FDFFFEFFFE000601F802FD01FF0000FC00FD01FFFA0306FCFD0203020100060203FEFCFEFF0002FB0101010203010300FF0200FE000403FDFEFA0101FCFD00FF02FFFFFFFCF9FFFDFE00FF01FDFF000002FCFFFD020103FBFBFE00FC0005FF0103FFFFFEFD000201010001000204FCFF01FD03FDFE00FF000400FE0100FFFF0301FDFE01FE0203FBFD00FF010401FEFDFB02FF0002"> : tensor<20x20xi8>
    return %c, %c_0 : tensor<20x20xi8>, tensor<20x20xi8>
  }
  func.func private @expected() -> (tensor<20x20xi8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0xFD03FEFFFFFF02FFFE05FEFF07FF010303FDFF0003FFFEFD0100060503FFFFFE00FDFEFEFC03FFFDFF00FFFDFFFFFF00FD00020201FFFF0103FD00FEFF0003000106FBFF0101FDFFFF070603FC02FE050104FFFEFF05FF03FCFE03FEFDF7FFFF00FEFFFF03FFFFFFFEFEFFFEFBFFFFFFFF06030002FFFDFEFFF907FBFF07FB03FF03FFFFFF0104FFFE04FBFFFC04FDFC00FFFFFE03FDFFFDFB00FC04FFFD02FE00FFFEFEFEFEFDFDFFFF01010404FF03FC010101FF0002010309FFFCFDFDFFFF07FE03000400FFFFFEFD0205FE020000000003FDFEFEFF0105FFFFFD0003FFFFFBFF02FD000107FFFFFFFF0503FF07FFFE03FFFEFEFF030301FF01FDFFFEFFFE0006FDF9FFFFFBFFFA02FDFEFDFDFFFAFF07FDFFFF03FF01FC060307FEFCFEFFFAFEFB0101FB03FB010302FF02FEFE000403FDFEFB0303FCFD05FF03FFFFFFFFFFFFFFFE00FFF9FFFFFFFF03FEFFFF0301FFFFFBFE02FD0207FFFDFFFFFFFEFD0002FB01FF03FD0205FCFF05FDFFFFFE03FFFFFE00FFFFFEFFFF03FDFDFF01FE0303FBFFFDFF010405FEFDFBFFFF03FB"> : tensor<20x20xi8>
    return %c : tensor<20x20xi8>
  }
}

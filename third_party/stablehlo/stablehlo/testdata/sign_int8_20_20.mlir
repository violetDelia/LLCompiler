// RUN: stablehlo-opt -inline %s | stablehlo-translate --interpret
// RUN: stablehlo-translate --serialize --target=current %s | stablehlo-translate --deserialize | stablehlo-opt > %t.0
// RUN: stablehlo-opt %s > %t.1
// RUN: diff %t.0 %t.1

module @jit_main attributes {mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main() -> (tensor<20x20xi8> {jax.result_info = "", mhlo.layout_mode = "default"}) {
    %0 = call @inputs() : () -> tensor<20x20xi8>
    %1 = call @expected() : () -> tensor<20x20xi8>
    %2 = stablehlo.sign %0 : tensor<20x20xi8>
    stablehlo.custom_call @check.expect_eq(%2, %1) {has_side_effect = true} : (tensor<20x20xi8>, tensor<20x20xi8>) -> ()
    return %2 : tensor<20x20xi8>
  }
  func.func private @inputs() -> (tensor<20x20xi8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x00040002FF02FDFF00000200040501FBFFFF0100FF01030000FCFE01FFFE0101F90002000201FF0000FE00000004FC040306FCFF01FF00000007FF01FE00030101FF03010004FD04FB000101FF01FFFFFE00FBFF01FCFEFD00000001FFFE03FC000201000001F8FE0300FF03FD0001000305040200FCFDFB00FF000004FBFC010000000000FEFC00FE00000100030504FB0003FEFE0100FD0202FD03FEFFFD03FF00050502FE0704000000FE0000FE0000030204060300FC0000010101FF09000106FFFFFFFF040005020003FDFF06FF01FE02FEFF02030201020000FF00FA01FDFE0003FFFF01FFFB06FE00FEFC01FFFCFD04FFFFFF04FC02FD00FD00FE01030203FE00FDFDFFFD00010100FC020004FE00FFFDFE01FBFF0100FD00010200FE02000C020000000002FFFDFC00FFFD01000000040100FC0000FF0003FF02FE03FFFE000100000106FB00040000FE0000FDFC00FF0203FF0200FEFDFEFE0200FD000404FE04FFFE01010000FB000101000100FEFE03030000FE0000FF0303FE03020100FC00FCFFFEFF00FA05FB060102"> : tensor<20x20xi8>
    return %c : tensor<20x20xi8>
  }
  func.func private @expected() -> (tensor<20x20xi8> {mhlo.layout_mode = "default"}) {
    %c = stablehlo.constant dense<"0x00010001FF01FFFF00000100010101FFFFFF0100FF01010000FFFF01FFFF0101FF0001000101FF0000FF00000001FF010101FFFF01FF00000001FF01FF00010101FF01010001FF01FF000101FF01FFFFFF00FFFF01FFFFFF00000001FFFF01FF000101000001FFFF0100FF01FF0001000101010100FFFFFF00FF000001FFFF010000000000FFFF00FF00000100010101FF0001FFFF0100FF0101FF01FFFFFF01FF00010101FF0101000000FF0000FF0000010101010100FF0000010101FF01000101FFFFFFFF010001010001FFFF01FF01FF01FFFF01010101010000FF00FF01FFFF0001FFFF01FFFF01FF00FFFF01FFFFFF01FFFFFF01FF01FF00FF00FF01010101FF00FFFFFFFF00010100FF010001FF00FFFFFF01FFFF0100FF00010100FF010001010000000001FFFFFF00FFFF01000000010100FF0000FF0001FF01FF01FFFF000100000101FF00010000FF0000FFFF00FF0101FF0100FFFFFFFF0100FF000101FF01FFFF01010000FF000101000100FFFF01010000FF0000FF0101FF01010100FF00FFFFFFFF00FF01FF010101"> : tensor<20x20xi8>
    return %c : tensor<20x20xi8>
  }
}
